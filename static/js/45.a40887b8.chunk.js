(this["webpackJsonpjecrc-project"]=this["webpackJsonpjecrc-project"]||[]).push([[45],{699:function(e,t,c){"use strict";c.r(t);var a=c(37),n=c(7),r=c(20),i=c(85),s=c.n(i),o=c(125),l=c(641),u=c(145),b=c(662),j=c(119),d=c(705),h=c(143),O=c(685),f=c(700),m=c(718),p=c(657),v=c(687),x=(c(100),c(58)),g=c(42),k=c(72),y=c(82),w=c.n(y),M=c(2),N=c(40),E=c.n(N),C=c(108),P=c(18),S=0,B=35,D=20,H=25;function I(e){var t=e.timeseries,c=e.dates,i=e.currentBrushSelection,y=e.endDate,w=e.lookback,N=e.setBrushSelectionEnd,I=e.setLookback,A=e.animationIndex,J=Object(M.useRef)(),R=Object(C.a)(),T=Object(a.a)(R,2),U=T[0],X=T[1],z=X.width,L=X.height,W=null!==w?Object(o.a)([Object(x.a)(Object(g.a)(Object(r.k)(c[0]),w),{representation:"date"}),y]):y,Y=Object(M.useMemo)((function(){var e=c.length,t=z-B;return Object(d.a)().clamp(!0).domain([Object(r.k)(c[0]||y),Object(r.k)(c[e-1]||y)]).range([H,t])}),[z,y,c]);Object(M.useEffect)((function(){if(z&&L){var e=L-D,i=Object(m.a)().keys(n.b).value((function(e,c){return Math.max(0,Object(r.h)(t[e],"delta",c))}))(c),s=Object(h.a)().clamp(!0).domain([0,Object(l.a)(i[i.length-1],(function(e){return 1.2*Object(a.a)(e,2)[1]}))]).range([e,S]),o=Object(O.a)(J.current),b=o.transition().duration(n.c);o.select(".x-axis").attr("pointer-events","none").style("transform","translate3d(0, ".concat(e,"px, 0)")).transition(b).call((function(e){return e.attr("class","x-axis").call(Object(u.a)(Y).ticks(function(e){return e<480?4:6}(z)))}));var d=Object(p.a)().curve(v.a).x((function(e){return Y(Object(r.k)(e.data))})).y0((function(e){return s(e[0])})).y1((function(e){return s(e[1])}));o.select(".trend-areas").selectAll(".trend-area").data(i).join((function(e){return e.append("path").attr("class","trend-area").attr("fill",(function(e){var t=e.key;return n.w[t].color})).attr("fill-opacity",.4).attr("stroke",(function(e){var t=e.key;return n.w[t].color})).attr("d",d).attr("pointer-events","none")}),(function(e){return e.transition(b).attrTween("d",(function(e){var t=Object(O.a)(this).attr("d"),c=d(e);return Object(j.interpolatePath)(t,c)})).selection()}))}}),[c,z,L,Y,t]);var _=i.map((function(e){return Y(Object(r.k)(e))})),q=Object(M.useMemo)((function(){if(z&&L){var e=z-B,t=L-D;return Object(b.b)().extent([[H,S],[e,t]]).handleSize(20)}}),[z,L]),F=Object(M.useCallback)((function(e){var t=e.sourceEvent,c=e.selection;if(t){var n=c.map(Y.invert),r=Object(a.a)(n,2),i=r[0],s=r[1];E.a.unstable_batchedUpdates((function(){N(Object(x.a)(s,{representation:"date"})),I(Object(k.a)(s,i))}))}}),[Y,N,I]),G=Object(M.useCallback)((function(e){var t=Object(O.a)(J.current),c=Object(b.a)(t.select(".brush").node());if(c){var n=c[1]-c[0],r=Object(f.a)(e),i=Object(a.a)(r,1),s=Object(a.a)(i[0],1)[0],o=s-n/2,l=s+n/2,u=Y.range(),j=Object(a.a)(u,2),d=j[0],h=j[1];t.select(".brush").call(q.move,l>h?[h-n,h]:o<d?[d,d+n]:[o,l])}}),[q,Y]),K=Object(M.useCallback)((function(e){var t=e.sourceEvent,c=e.selection;if(t&&c){var a=c.map(Y.invert).map((function(e){return Object(x.a)(e,{representation:"date"})}));Object(O.a)(J.current).select(".brush").call(q.move,a.map((function(e){return Y(Object(r.k)(e))}))).call((function(e){return e.select(".overlay").attr("cursor","pointer")}))}}),[q,Y]);Object(M.useEffect)((function(){q&&(q.on("start brush",F).on("end",K),Object(O.a)(J.current).select(".brush").call(q).call((function(e){return e.select(".overlay").attr("cursor","pointer").datum({type:"selection"}).on("mousedown touchstart",G)})))}),[q,F,K,G]),Object(M.useEffect)((function(){q&&Object(O.a)(J.current).select(".brush").call(q.move,_)}),[q,_]);return Object(P.jsx)("div",{className:"Timeseries",children:Object(P.jsx)("div",{className:s()("svg-parent is-brush fadeInUp"),ref:U,onWheel:function(e){e.deltaX&&N(Object(l.a)([W,c[Math.max(0,Math.min(c.length-1,c.indexOf(i[1])+10*Math.sign(e.deltaX)))]]))},style:{animationDelay:"".concat(250*A,"ms")},children:Object(P.jsxs)("svg",{ref:J,preserveAspectRatio:"xMidYMid meet",children:[Object(P.jsxs)("defs",{children:[Object(P.jsx)("clipPath",{id:"clipPath",children:Object(P.jsx)("rect",{x:0,y:"".concat(S),width:z,height:"".concat(Math.max(0,L-D))})}),Object(P.jsxs)("mask",{id:"mask",children:[Object(P.jsx)("rect",{x:0,y:"".concat(S),width:z,height:"".concat(Math.max(0,L-D)),fill:"hsl(0, 0%, 40%)"}),Object(P.jsx)("use",{href:"#selection",fill:"white"})]})]}),Object(P.jsx)("g",{className:"brush",clipPath:"url(#clipPath)",children:Object(P.jsxs)("g",{mask:"url(#mask)",children:[Object(P.jsx)("rect",{className:"overlay"}),Object(P.jsx)("g",{className:"trend-areas"}),Object(P.jsx)("rect",{className:"selection",id:"selection"})]})}),Object(P.jsx)("g",{className:"x-axis"})]})})})}var A=function(e,t){return!!w()(t.currentBrushSelection,e.currentBrushSelection)&&(!!w()(t.regionHighlighted.stateCode,e.regionHighlighted.stateCode)&&(!!w()(t.regionHighlighted.districtName,e.regionHighlighted.districtName)&&(!!w()(t.endDate,e.endDate)&&(!!w()(t.lookback,e.lookback)&&(!!w()(t.animationIndex,e.animationIndex)&&!!w()(t.dates,e.dates))))))};t.default=Object(M.memo)(I,A)}}]);
//# sourceMappingURL=45.a40887b8.chunk.js.map